<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini E-shop Asity</title>
<style>
body { font-family:sans-serif; margin:0; padding:0; background:#000; color:#fff; text-align:center;}
header { padding:15px 20px; background:#111; display:flex; justify-content:center; align-items:center; gap:20px; position:relative;}
header img { max-width:300px; height:auto; cursor:pointer; }

.cart-container { position:absolute; top:10px; right:10px; text-align:center; }
.cart-price{ font-size:14px; color:#0f0; }
.cart-icon{ font-size:24px; cursor:pointer; margin-top:5px; }

.product{margin:80px auto 30px auto; background:#111; padding:20px; max-width:400px; box-shadow:0 2px 5px rgba(255,255,255,0.2); border-radius:10px;}
.carousel{position:relative; margin-bottom:15px; display:flex; justify-content:center; align-items:center;}
.carousel img{max-width:100%; display:block; border-radius:5px; cursor:pointer;}
.arrow{position:absolute; top:50%; transform:translateY(-50%); font-size:30px; color:#fff; cursor:pointer; background:rgba(0,0,0,0.4); padding:5px 10px; border-radius:5px; user-select:none;}
.arrow.left{left:5px;} 
.arrow.right{right:5px;}

.size-container, .qty-container{margin:15px 0; text-align:center;}
.size-container select, .qty-container select{width:50%; padding:10px; font-size:16px; border-radius:5px; border:none; text-align:center;}

.product button{padding:10px 20px; font-size:16px; cursor:pointer; background:#6772e5; color:#fff; border:none; border-radius:5px; margin-top:10px;}

.cart-modal{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:999; justify-content:center; align-items:center;}
.cart{background:#111; padding:15px 20px; max-width:350px; width:90%; border-radius:10px; box-shadow:0 2px 10px rgba(255,255,255,0.3); position:relative; text-align:center; max-height:90vh; overflow-y:auto;}
.cart input, .cart select, .cart textarea{width:90%; padding:8px; margin:5px 0; font-size:14px; border-radius:4px; border:none;}
.cart textarea{resize:vertical; min-height:50px;}
.cart button{padding:10px 16px; font-size:15px; cursor:pointer; background:#6772e5; color:#fff; border:none; border-radius:5px; margin-top:10px;}
.close-btn{position:absolute; top:10px; right:15px; font-size:20px; color:#fff; cursor:pointer;}
.remove-item{cursor:pointer; color:red; margin-left:8px; font-weight:bold;}
label{display:block; margin-top:6px;}

.lightbox{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); justify-content:center; align-items:center; z-index:1000;}
.lightbox img{max-width:90%; max-height:90%; border-radius:5px; cursor:pointer;}

@media (max-width:600px){
  header img{max-width:200px;}
  .arrow{font-size:24px; padding:4px 8px;}
  .size-container select, .qty-container select{width:70%; font-size:14px;}
  .cart input, .cart select, .cart textarea{width:95%; font-size:13px;}
  .cart{max-width:95%;}
}
</style>
</head>
<body>

<header>
  <img src="DWDasitynormalny.jpg" alt="Logo">
  <div class="cart-container">
    <div id="cartTotal" class="cart-price">0 ‚Ç¨</div>
    <div id="cartIcon" class="cart-icon">üõí</div>
  </div>
</header>

<div class="product">
  <h2>Shirt</h2>
  <div class="carousel">
    <span class="arrow left" id="prev">&#10094;</span>
    <img src="poster 001.jpg" id="productImg" alt="Triƒçko">
    <span class="arrow right" id="next">&#10095;</span>
  </div>

  <div class="size-container">
    <label for="size">Veƒækos≈•:</label>
    <select id="size">
      <option value="M" selected>M</option>
      <option value="L">L</option>
      <option value="XL">XL</option>
    </select>
  </div>

  <div class="qty-container">
    <label for="quantity">Poƒçet kusov:</label>
    <select id="quantity">
      <option value="1" selected>1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
    </select>
  </div>

  <p>Cena: 23 ‚Ç¨</p>
  <p>Product Description: 100% cotton oversize unisex shirt and high quality screen printing.</p>
  <button id="addToCart">Prida≈• do ko≈°√≠ka</button>
</div>

<div class="cart-modal" id="cartModal">
  <div class="cart" id="cart">
    <span class="close-btn" id="closeCart">&times;</span>
    <h3>Ko≈°√≠k</h3>
    <div id="cartItems"></div>
    <p id="total"></p>

    <input type="text" id="name" placeholder="Meno a priezvisko">
    <input type="email" id="email" placeholder="Email">
    <input type="tel" id="phone" placeholder="Telef√≥n">
    <input type="text" id="street" placeholder="Ulica a popisn√© ƒç√≠slo">
    <input type="text" id="zip" placeholder="PSƒå">
    <textarea id="note" placeholder="Pozn√°mka k objedn√°vke"></textarea>

    <label for="country">Krajina doruƒçenia:</label>
    <select id="country">
      <option value="Slovensko" selected>Slovensko</option>
      <option value="ƒåesk√° republika">ƒåesk√° republika</option>
    </select>

    <label for="delivery">Packeta Sp√¥sob doruƒçenia:</label>
    <select id="delivery">
      <option value="V√Ωdajn√© miesto">V√Ωdajn√© miesto</option>
      <option value="Z-Box">Z-Box</option>
    </select>

    <label><input type="checkbox" id="cod"> Platba dobierkou (+1,40 ‚Ç¨)</label>
    <button id="payBtn">Objedna≈• na dobierku</button>
  </div>
</div>

<div class="lightbox" id="lightbox">
  <img id="lightboxImg" src="">
</div>

<script>
const images=["trikomore.jpg","0001.jpg","2006.jpg"];
let current=0;
let cartData=[];
const productImg=document.getElementById("productImg");
const lightbox=document.getElementById("lightbox");
const lightboxImg=document.getElementById("lightboxImg");

// Carousel
document.getElementById("prev").addEventListener("click",()=>{current=(current-1+images.length)%images.length; productImg.src=images[current];});
document.getElementById("next").addEventListener("click",()=>{current=(current+1)%images.length; productImg.src=images[current];});

// Lightbox
productImg.addEventListener("click", ()=>{
  lightbox.style.display="flex";
  lightboxImg.src=productImg.src;
});
lightbox.addEventListener("click", ()=>{ lightbox.style.display="none"; });

const cartModal=document.getElementById("cartModal");
const cartItems=document.getElementById("cartItems");
const total=document.getElementById("total");
const closeCart=document.getElementById("closeCart");
const cartIcon=document.getElementById("cartIcon");
const cartCount=document.getElementById("cartCount");
const cartTotal=document.getElementById("cartTotal");
const countrySelect=document.getElementById("country");
const codCheckbox=document.getElementById("cod");

function getShipping(){ return countrySelect.value==="ƒåesk√° republika"?4.50:3.50; }
function getCOD(){ return codCheckbox.checked?1.40:0; }

function renderCart(){
  const shipping=getShipping();
  const cod=getCOD();
  if(cartData.length===0){
    cartItems.innerHTML="<em>Ko≈°√≠k je pr√°zdny</em>";
    total.innerHTML="";
    cartTotal.textContent="0 ‚Ç¨";
    return;
  }
  cartItems.innerHTML=cartData.map((item,index)=>
    `<p>${item.product} (${item.size}) x${item.qty} - ${(item.price*item.qty).toFixed(2)} ‚Ç¨
      <span class="remove-item" data-index="${index}">‚ùå</span></p>`).join('');
  const subtotal=cartData.reduce((sum,i)=>sum+i.price*i.qty,0);
  const totalPrice=(subtotal+shipping+cod).toFixed(2);

  total.innerHTML=`Medzis√∫ƒçet: ${subtotal.toFixed(2)} ‚Ç¨<br>Po≈°tovn√©: ${shipping.toFixed(2)} ‚Ç¨<br>Dobierka: ${cod.toFixed(2)} ‚Ç¨<br><strong>Celkom: ${totalPrice} ‚Ç¨</strong>`;

  cartTotal.textContent=subtotal.toFixed(2)+" ‚Ç¨";

  document.querySelectorAll(".remove-item").forEach(btn=>{
    btn.addEventListener("click",()=>{
      const index=btn.getAttribute("data-index");
      cartData.splice(index,1);
      renderCart();
    });
  });
}

cartIcon.addEventListener("click",()=>{ renderCart(); cartModal.style.display="flex"; });
closeCart.addEventListener("click",()=>{ cartModal.style.display="none"; });
cartModal.addEventListener("click",(e)=>{ if(e.target===cartModal) cartModal.style.display="none"; });

document.getElementById("addToCart").addEventListener("click",()=>{
  const size=document.getElementById("size").value;
  const qty=parseInt(document.getElementById("quantity").value)||1;
  cartData.push({product:"Triƒçko", size:size, price:23, qty:qty});
  renderCart();
});

countrySelect.addEventListener("change", renderCart);
codCheckbox.addEventListener("change", renderCart);

const payBtn=document.getElementById("payBtn");
payBtn.addEventListener("click",async()=>{
  if(cartData.length===0){ alert("Ko≈°√≠k je pr√°zdny!"); return; }
  if(!codCheckbox.checked){ alert("Objedn√°vka mus√≠ by≈• na dobierku!"); return; }

  const name=document.getElementById("name").value.trim();
  const email=document.getElementById("email").value.trim();
  const phone=document.getElementById("phone").value.trim();
  const street=document.getElementById("street").value.trim();
  const zip=document.getElementById("zip").value.trim();
  const country=document.getElementById("country").value;
  const note=document.getElementById("note").value.trim();
  const delivery=document.getElementById("delivery").value;

  if(!name||!email||!phone||!street||!zip){ alert("Vypl≈à v≈°etky povinn√© polia!"); return; }

  await fetch("/.netlify/functions/send-order",{
    method:"POST",
    body:JSON.stringify({name,email,phone,street,zip,country,note,delivery,cod:true,cart:cartData})
  });

  alert("Objedn√°vka bola odoslan√°!");
  cartData=[];
  renderCart();
});
</script>

</body>
</html>
